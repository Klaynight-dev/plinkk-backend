<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Plinkk Â· Dashboard</title>
        <script src="https://cdn.tailwindcss.com"></script>
    </head>
    <body class="bg-slate-950 text-slate-100 min-h-dvh">
        <header class="border-b border-slate-800 bg-slate-900/60 backdrop-blur sticky top-0 z-40">
            <div class="max-w-7xl mx-auto px-4 py-3 flex items-center gap-4">
                <img src="/<%= user.id %>/images/logo.png" alt="Plinkk" class="h-8 w-8 rounded" onerror="this.src='/public/images/logo.png'" />
                <div class="flex-1 min-w-0">
                    <h1 class="text-base sm:text-lg font-semibold truncate">
                        Tableau de bord Â· <span class="text-indigo-400"><%= user.userName %></span>
                    </h1>
                    <p class="text-xs text-slate-400 truncate"><%= user.email %></p>
                </div>
                <nav class="flex items-center gap-2 flex-wrap justify-end">
                    <span class="px-3 py-2 text-sm rounded-md bg-slate-800 border border-slate-700 text-slate-300">RÃ©sumÃ©</span>
                    <a href="/dashboard/edit" class="px-3 py-2 text-sm rounded-md bg-indigo-600 hover:bg-indigo-500">Ã‰diter</a>
                    <a href="/dashboard/stats" class="px-3 py-2 text-sm rounded-md bg-slate-800 hover:bg-slate-700 border border-slate-700">Statistiques</a>
                    <a href="/dashboard/versions" class="px-3 py-2 text-sm rounded-md bg-slate-800 hover:bg-slate-700 border border-slate-700">Versions</a>
                    <a target="_blank" href="/<%= user.id %>" class="px-3 py-2 text-sm rounded-md bg-slate-800 hover:bg-slate-700 border border-slate-700">Voir le profil</a>
                    <a href="/logout" class="px-3 py-2 text-sm rounded-md bg-slate-800 hover:bg-slate-700 border border-slate-700">DÃ©connexion</a>
                </nav>
            </div>
        </header>

        <main class="max-w-7xl mx-auto p-4 grid grid-cols-12 gap-4">
            <!-- Colonne gauche: RÃ©capitulatif -->
            <section class="col-span-12 xl:col-span-8 space-y-4">
                <div class="rounded-lg border border-slate-800 bg-slate-900/60 p-4">
                    <div class="flex items-center justify-between gap-2 mb-2">
                        <h2 class="text-base font-semibold">RÃ©sumÃ© du compte</h2>
                        <a href="/dashboard/edit" class="px-3 py-2 text-sm rounded-md bg-indigo-600 hover:bg-indigo-500">Modifier le profil</a>
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <p class="text-xs text-slate-400 mb-1">Nom d'utilisateur</p>
                            <p class="font-medium"><%= user.userName %> <span class="text-slate-400">(@<%= user.id %>)</span></p>
                        </div>
                        <div>
                            <p class="text-xs text-slate-400 mb-1">Email</p>
                            <p class="font-medium"><%= user.email %></p>
                        </div>
                        <div>
                            <p class="text-xs text-slate-400 mb-1">CrÃ©Ã© le</p>
                            <p class="font-medium"><%= new Date(user.createdAt).toLocaleDateString('fr-FR') %></p>
                        </div>
                        <div>
                            <p class="text-xs text-slate-400 mb-1">DerniÃ¨re mise Ã  jour</p>
                            <p class="font-medium"><%= new Date(user.updatedAt).toLocaleString('fr-FR') %></p>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="rounded-lg border border-slate-800 bg-slate-900/60 p-4">
                        <p class="text-xs text-slate-400">Liens</p>
                        <p class="text-3xl font-bold"><%= stats.links %></p>
                    </div>
                    <div class="rounded-lg border border-slate-800 bg-slate-900/60 p-4">
                        <p class="text-xs text-slate-400">IcÃ´nes sociales</p>
                        <p class="text-3xl font-bold"><%= stats.socials %></p>
                    </div>
                    <div class="rounded-lg border border-slate-800 bg-slate-900/60 p-4">
                        <p class="text-xs text-slate-400">Labels</p>
                        <p class="text-3xl font-bold"><%= stats.labels %></p>
                    </div>
                </div>

                <div class="rounded-lg border border-slate-800 bg-slate-900/60 p-4">
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="font-medium">AperÃ§u rapide des liens</h3>
                        <a href="/dashboard/edit#section-links" class="text-sm text-indigo-400 hover:text-indigo-300">GÃ©rer</a>
                    </div>
                    <% if (links && links.length) { %>
                        <ul class="divide-y divide-slate-800">
                            <% links.slice(0, 6).forEach(l => { %>
                                <li class="py-2 flex items-center gap-3">
                                    <div class="h-5 w-5 rounded bg-slate-700 flex items-center justify-center text-[10px] shrink-0">ðŸ”—</div>
                                    <div class="min-w-0">
                                        <p class="truncate font-medium"><%= l.name || l.text || l.url %></p>
                                        <p class="truncate text-xs text-slate-400"><%= l.url %></p>
                                    </div>
                                </li>
                            <% }) %>
                        </ul>
                    <% } else { %>
                        <p class="text-sm text-slate-400">Aucun lien pour le moment.</p>
                    <% } %>
                </div>
            </section>

            <!-- Colonne droite: AperÃ§u de la page publique -->
            <aside class="col-span-12 xl:col-span-4 space-y-3">
                <div class="rounded-lg border border-slate-800 bg-slate-900/60 p-3 sticky top-[68px]">
                    <div class="flex items-center justify-between gap-2 mb-2">
                        <h2 class="text-base font-semibold">AperÃ§u</h2>
                        <div class="flex items-center gap-2">
                            <a class="px-3 py-2 text-xs rounded-md bg-slate-800 hover:bg-slate-700 border border-slate-700" target="_blank" href="/<%= user.id %>">Ouvrir</a>
                        </div>
                    </div>
                    <iframe class="w-full h-[72dvh] rounded border border-slate-800 bg-white" src="/<%= user.id %>"></iframe>
                </div>
            </aside>
        </main>

    </body>
</html>
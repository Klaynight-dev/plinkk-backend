<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Connexion / Inscription - Plinkk</title>
  <link rel="icon" href="/public/images/logo.svg" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      :root{ --ease-out-quad: cubic-bezier(.22,1,.36,1); }
      @keyframes fade-in { from { opacity: 0 } to { opacity: 1 } }
      @keyframes slide-up { from { opacity: 0; transform: translateY(8px) } to { opacity: 1; transform: translateY(0) } }
      .animate-fade-in { animation: fade-in .36s var(--ease-out-quad) both }
      .animate-slide-up { animation: slide-up .38s var(--ease-out-quad) both }
    </style>
  </head>
  <body class="min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-indigo-950 text-slate-100 grid place-items-center p-4 animate-fade-in">
    <main class="w-full max-w-md">
      <div class="mb-6 flex items-center justify-center gap-2 text-slate-200 animate-slide-up">
        <img src="/public/images/logo.svg" alt="Plinkk" class="h-9 w-9 rounded" />
        <h1 class="text-xl font-semibold">Plinkk</h1>
      </div>

      <div class="rounded-2xl border border-slate-800/60 bg-slate-900/60 shadow overflow-hidden animate-slide-up" style="animation-delay:60ms">
        <nav class="grid grid-cols-2 text-sm">
          <button id="tabLogin" class="px-4 py-3 font-medium border-b-2 border-indigo-500 text-indigo-300">Connexion</button>
          <button id="tabSignup" class="px-4 py-3 font-medium border-b-2 border-transparent text-slate-400 hover:text-slate-200">Inscription</button>
        </nav>

        <!-- Connexion -->
        <section id="loginForm" class="p-5 space-y-4">
          <form action="/login" method="post" class="space-y-3">
            <label class="block text-sm">
              <span class="text-slate-300">Adresse e-mail</span>
              <input type="email" name="email" required class="mt-1 w-full rounded bg-slate-900/60 border border-slate-800/60 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-600/50" placeholder="vous@exemple.com" />
            </label>
            <label class="block text-sm">
              <span class="text-slate-300">Mot de passe</span>
              <input type="password" name="password" required class="mt-1 w-full rounded bg-slate-900/60 border border-slate-800/60 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-600/50" placeholder="••••••••" />
            </label>
            <button type="submit" class="w-full mt-2 rounded-md bg-indigo-600 hover:bg-indigo-500 text-white font-medium py-2.5 shadow transition-colors">Se connecter</button>
          </form>
          <p class="errorClass"></p>
          <p class="text-center text-xs text-slate-400">Pas de compte ? <button id="switchToSignup" class="text-indigo-300 hover:text-indigo-200 underline underline-offset-4">Créer un compte</button></p>
        </section>

        <!-- Inscription -->
        <section id="signupForm" class="p-5 space-y-4 hidden">
          <form action="/register" method="post" class="space-y-3">
            <label class="block text-sm">
              <span class="text-slate-300">Nom d'utilisateur</span>
              <input type="text" name="username" required class="mt-1 w-full rounded bg-slate-900/60 border border-slate-800/60 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-600/50" placeholder="votrepseudo" />
            </label>
            <label class="block text-sm">
              <span class="text-slate-300">Adresse e-mail</span>
              <input type="email" name="email" required class="mt-1 w-full rounded bg-slate-900/60 border border-slate-800/60 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-600/50" placeholder="vous@exemple.com" />
            </label>
            <label class="block text-sm">
              <span class="text-slate-300">Mot de passe</span>
              <input type="password" name="password" required class="mt-1 w-full rounded bg-slate-900/60 border border-slate-800/60 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-600/50" placeholder="••••••••" />
            </label>
            <label class="block text-sm">
              <span class="text-slate-300">Confirmer le mot de passe</span>
              <input type="password" name="passwordVerif" required class="mt-1 w-full rounded bg-slate-900/60 border border-slate-800/60 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-600/50" placeholder="••••••••" />
            </label>
            <button type="submit" class="w-full mt-2 rounded-md bg-emerald-600 hover:bg-emerald-500 text-white font-medium py-2.5 shadow transition-colors">S'inscrire</button>
          </form>
          <p class="errorClass"></p>
          <p class="text-center text-xs text-slate-400">Déjà un compte ? <button id="switchToLogin" class="text-indigo-300 hover:text-indigo-200 underline underline-offset-4">Se connecter</button></p>
        </section>
      </div>
    </main>

    <script>
      function getQueryVariable(variable){
        const query = window.location.search.substring(1);
        const vars = query.split('&');
        for(const v of vars){
          const pair = v.split('=');
          if(pair[0] === variable){ return pair[1]; }
        }
        return '';
      }

      function showError(message){
        const nodes = document.getElementsByClassName('errorClass');
        for(const el of nodes){
          el.textContent = message;
          el.className = 'errorClass mt-1 rounded-lg border border-rose-700 bg-rose-900/40 text-rose-200 text-sm px-3 py-2';
        }
      }

      function activateTab(which){
        const login = document.getElementById('loginForm');
        const signup = document.getElementById('signupForm');
        const tabLogin = document.getElementById('tabLogin');
        const tabSignup = document.getElementById('tabSignup');
        const isLogin = which === 'login';
        login.classList.toggle('hidden', !isLogin);
        signup.classList.toggle('hidden', isLogin);
        tabLogin.className = isLogin ? 'px-4 py-3 font-medium border-b-2 border-indigo-500 text-indigo-300' : 'px-4 py-3 font-medium border-b-2 border-transparent text-slate-400 hover:text-slate-200';
        tabSignup.className = !isLogin ? 'px-4 py-3 font-medium border-b-2 border-indigo-500 text-indigo-300' : 'px-4 py-3 font-medium border-b-2 border-transparent text-slate-400 hover:text-slate-200';
      }

      document.addEventListener('DOMContentLoaded', () => {
        const err = getQueryVariable('error');
        if(err){ showError(decodeURIComponent(err)); }

        document.getElementById('tabLogin').addEventListener('click', ()=> activateTab('login'));
        document.getElementById('tabSignup').addEventListener('click', ()=> activateTab('signup'));
        document.getElementById('switchToSignup').addEventListener('click', ()=> activateTab('signup'));
        document.getElementById('switchToLogin').addEventListener('click', ()=> activateTab('login'));

        // Si l'URL contient #signup, ouvrir directement l'onglet Inscription
        if(location.hash === '#signup'){ activateTab('signup'); }
      });
    </script>
  </body>
</html>
